function generateGUID(){do var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)});while(GUIDList.indexOf(e)>-1);return e}function Obj(){this._parent=null,this._handlers=[],this._onceHandlers=[],this._elements=$(),this.guid=generateGUID(),this.on=function(e,t){"function"==typeof e&&void 0===t&&(t=e,e="all"),e=e.toLowerCase().split(" ");for(var i=0;i<e.length;i++)this._handlers.push({event:e[i],handler:t});return this},this.once=function(e,t){"function"==typeof e&&void 0===t&&(t=e,e="all"),e=e.toLowerCase().split(" ");for(var i=0;i<e.length;i++)this._onceHandlers.push({event:e[i],handler:t});return this},this.off=function(e,t){if(void 0===t&&"function"==typeof e)for(var t=e,i=0;i<this._handlers.length;i++)this._handlers[i].handler==t&&this._handlers.splice(i--,1);else if(void 0===t&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)e.indexOf(this._handlers[i].event)>-1&&this._handlers.splice(i--,1)}else{e=e.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)e.indexOf(this._handlers[i].event)>-1&&this._handlers[i].handler==t&&this._handlers.splice(i--,1)}return this},this.offOnce=function(e,t){if(void 0===t&&"function"==typeof e)for(var t=e,i=0;i<this._onceHandlers.length;i++)this._onceHandlers[i].handler==t&&this._onceHandlers.splice(i--,1);else if(void 0===t&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var i=0;i<this._onceHandlers.length;i++)e.indexOf(this._onceHandlers[i].event)>-1&&this._onceHandlers.splice(i--,1)}else{e=e.toLowerCase().split(" ");for(var i=0;i<this._onceHandlers.length;i++)e.indexOf(this._onceHandlers[i].event)>-1&&this._onceHandlers[i].handler==t&&this._onceHandlers.splice(i--,1)}return this},this.trigger=function(e,t){e=e.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)(e.indexOf(this._handlers[i].event)>-1||"all"==this._handlers[i].event)&&this._handlers[i].handler.call(this,this._handlers[i].event,t);for(var i=0;i<this._onceHandlers.length;i++)(e.indexOf(this._onceHandlers[i].event)>-1||"all"==this._handlers[i].event)&&(this._onceHandlers[i].handler.call(this,this._onceHandlers[i].event,t),this._onceHandlers.splice(i--,1));return this},this.subscribe=function(e){return void 0!=e.listener&&"function"==typeof e.listener&&this.on("all",e.listener),this},this.ubsubscribe=function(e){return void 0!=e.listener&&"function"==typeof e.listener&&this.off("all",e.listener),this},this.publish=function(e,t){return this.trigger(e,t)},this.renderer=function(){return $("<div class='Obj'></div>")},this.refresher=function(e){return this.renderer.apply(this)},this.destroyer=function(e){},this.render=function(e,t){var i=this;if(void 0===e)var e="body";if(void 0===t)var t="replace";else t=t.toLowerCase();var n=[].slice.call(arguments,2),s=this;return $(e).each(function(e,r){r=$(r);var h=$(i.renderer.apply(i,n));h.attr("guid",i.guid),i._elements=i._elements.add(h),"append"==t?r.append(h):"prepend"==t?r.prepend(h):"after"==t?r.after(h):"before"==t?r.before(h):"return"==t?s=h:"none"==t||(r.after(h),r.remove())}),this.trigger("render"),s},this.refresh=function(){for(var e=$(),t=0;t<this._elements.length;t++){var i=this._elements.eq(t),n=this.refresher.call(this,i);n?(i.after(n),i.remove(),e=e.add(n)):e=e.add(i)}return this._elements=e,this},this.destroy=function(){var e=this;return this._elements.each(function(t,i){i=$(i),e.destroyer.apply(e,i)}),this._elements.remove(),this._elements=$(),this}}var GUIDList=[];