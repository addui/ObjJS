function extend(e,n){e.prototype=new n,e.prototype.constructor=e}var Obj=function(){this._handlers=[],this._onceHandlers=[],this._elements=$(),this.on=function(e,n){"function"==typeof e&&void 0===n&&(n=e,e="all"),e=e.toLowerCase().split(" ");for(var t=0;t<e.length;t++)this._handlers.push({event:e[t],handler:n});return this},this.once=function(e,n){"function"==typeof e&&void 0===n&&(n=e,e="all"),e=e.toLowerCase().split(" ");for(var t=0;t<e.length;t++)this._onceHandlers.push({event:e[t],handler:n});return this},this.off=function(e,n){if(void 0===n&&"function"==typeof e)for(var n=e,t=0;t<this._handlers.length;t++)this._handlers[t].handler==n&&this._handlers.splice(t--,1);else if(void 0===n&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var t=0;t<this._handlers.length;t++)e.indexOf(this._handlers[t].event)>-1&&this._handlers.splice(t--,1)}else{e=e.toLowerCase().split(" ");for(var t=0;t<this._handlers.length;t++)e.indexOf(this._handlers[t].event)>-1&&this._handlers[t].handler==n&&this._handlers.splice(t--,1)}return this},this.offOnce=function(e,n){if(void 0===n&&"function"==typeof e)for(var n=e,t=0;t<this._onceHandlers.length;t++)this._onceHandlers[t].handler==n&&this._onceHandlers.splice(t--,1);else if(void 0===n&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var t=0;t<this._onceHandlers.length;t++)e.indexOf(this._onceHandlers[t].event)>-1&&this._onceHandlers.splice(t--,1)}else{e=e.toLowerCase().split(" ");for(var t=0;t<this._onceHandlers.length;t++)e.indexOf(this._onceHandlers[t].event)>-1&&this._onceHandlers[t].handler==n&&this._onceHandlers.splice(t--,1)}return this},this.trigger=function(e,n){e=e.toLowerCase().split(" ");for(var t=0;t<this._handlers.length;t++)(e.indexOf(this._handlers[t].event)>-1||e.indexOf("all")>-1)&&this._handlers[t].handler.call(this,this._handlers[t].event,n);for(var t=0;t<this._onceHandlers.length;t++)(e.indexOf(this._onceHandlers[t].event)>-1||e.indexOf("all")>-1)&&(this._onceHandlers[t].handler.call(this,this._onceHandlers[t].event,n),this._onceHandlers.splice(t--,1));return e.indexOf("change")>-1&&this.refresh(),this},this.subscribe=function(e){return void 0!=e.listener&&"function"==typeof e.listener&&this.on("all",e.listener),this},this.ubsubscribe=function(e){return void 0!=e.listener&&"function"==typeof e.listener&&this.off("all",e.listener),this},this.publish=function(e,n){return this.trigger(e,n)},this.renderer=function(){return $("<div class='Obj'></div>")},this.refresher=function(e){return this.renderer()},this.destroyer=function(e){},this.render=function(e){var n=this;return $(e).each(function(e,t){t=$(t);var s=n.renderer.call(this);n._elements=n._elements.add(s),t.append(s)}),this},this.refresh=function(){for(var e=$(),n=0;n<this._elements.length;n++){var t=this._elements.eq(n),s=this.refresher.call(this,t);s?(t.after(s),t.remove(),e=e.add(s)):e=e.add(t)}return this._elements=e,this},this.destroy=function(){var e=this;return this._elements.each(function(n,t){t=$(t),e.destroyer(t)}),this._elements.remove(),this}};