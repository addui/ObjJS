var Obj,Objs={};!function(){function e(){do var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)});while(t.indexOf(e)>-1);return e}function i(t){if("function"==typeof t)return t;if("string"==typeof t){if(void 0!=window[t]&&"function"==typeof window[t])return window[t];try{return new Function(t)}catch(e){}}return function(){return t}}var t=[];Obj=function(){this.guid=e(),this._handlers=[],this.on=function(t,e,i){for(var r="all",n=null,s=0,a=0;a<arguments.length;a++)"string"==typeof arguments[a]?r=arguments[a].toLowerCase().split(" "):arguments[a]instanceof Array?r=$.map(arguments[a],function(t,e){return t.toLowerCase()}):"function"==typeof arguments[a]?n=arguments[a]:"number"==typeof arguments[a]&&(s=arguments[a]);if(!n)return this;for(var a=0;a<r.length;a++)this._handlers.push({event:r[a],handler:n,max_count:s,trigger_count:0});return this},this.off=function(t,e){if(void 0===e&&"function"==typeof t)for(var e=t,i=0;i<this._handlers.length;i++)this._handlers[i].handler==e&&this._handlers.splice(i--,1);else if(void 0===e&&"string"==typeof t){t=t.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)t.indexOf(this._handlers[i].event)>-1&&this._handlers.splice(i--,1)}else{t=t.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)t.indexOf(this._handlers[i].event)>-1&&this._handlers[i].handler==e&&this._handlers.splice(i--,1)}return this},this.trigger=function(t,e){t=t.toLowerCase().split(" ");for(var r=0;r<this._handlers.length;r++)(t.indexOf(this._handlers[r].event)>-1||"all"==this._handlers[r].event)&&i(this._handlers[r].handler).call(this,this._handlers[r].event,e);return this},this._elements=$(),this.renderer=function(){var t=$("<div class='Obj'></div>");for(var e in this)0==e.indexOf("_")&&-1==["_handlers","_elements"].indexOf(e)&&t.append("<div class='Obj-member'><div class='Obj-member-key'>"+e.substr(1)+"</div><div class='Obj-member-value'>"+this[e]+"</div></div>");return t},this.refresher=function(t){return this.renderer.apply(this)},this.destroyer=function(t){},this.render=function(t,e){var i=this;if(void 0===t)var t="body";if(void 0===e)var e="append";else e=e.toLowerCase();var r=[].slice.call(arguments,2),n=this;return $(t).each(function(t,s){s=$(s);var a=$(i.renderer.apply(i,r));a.attr("guid",i.guid),i._elements=i._elements.add(a),"append"==e?s.append(a):"prepend"==e?s.prepend(a):"after"==e?s.after(a):"before"==e?s.before(a):"return"==e?n=a:"replace"==e&&(s.after(a),s.remove())}),this.trigger("render"),n},this.refresh=function(t){for(var e=$(),i=0;i<this._elements.length;i++){var r=this._elements.eq(i),n=this.refresher.call(this,r,t);n?(n.attr("guid",this.guid),this._elements=this._elements.not(r),r.after(n),r.remove(),e=e.add(n)):e=e.add(r)}return this._elements=e,this},this.destroy=function(){var t=this;return this._elements.each(function(e,i){var r=$(i);t.destroyer.call(t,r)}),this._elements.remove(),this._elements=$(),delete Objs[this.guid],this},this.defMember=function(t,e,i,r){for(var s=["handlers","on","off","trigger","elements","render","renderer","refresh","refresher","destroy","destroyer","defMember","defSettings","defMethod","guid"],a=0;s>a;a++)if(s[a]==t||"_"+s[a]==t)return!1;this["_"+t]=void 0===e?null:e,Object.defineProperty(this,t,{get:function(){var e=this["_"+t];return r&&(e=r(e)),this.trigger("get"+t+" "+t,e),e},set:function(e){if(i){var r=i(e);void 0!==r&&(e=r)}this["_"+t]=e,this.trigger("set"+t+" "+t,e),this.refresh(t)}})},this.defSettings=function(t){if(void 0===t)var t={};this._settings=t,Object.defineProperty(this,"settings",{get:function(){return this.trigger("getsettings settings",this._settings),this._settings},set:function(t){this._settings=$.extend(this._settings,t),this.trigger("setsettings settings",this._settings),this.refresh("settings")}})},this.defMethod=function(t,e){var i=this;this["_"+t]=e,this[t]=function(){var e=i["_"+t].call(i,arguments);return i.trigger(t,arguments),e}},Objs[this.guid]=this}}();