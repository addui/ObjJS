function generateGUID(){do var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var r=16*Math.random()|0,e="x"==t?r:3&r|8;return e.toString(16)});while(GUIDList.indexOf(t)>-1);return t}function toFunc(t){if("function"==typeof t)return t;if("string"==typeof t){if(void 0!=window[t]&&"function"==typeof window[t])return window[t];try{return new Function(t)}catch(r){}}return function(){return t}}function Obj(){this._parent=null,this._handlers=[],this._onceHandlers=[],this._elements=$(),this.guid=generateGUID(),this.defProp=function(t,r,e,i){if(["parent","handlers","onceHandlers","elements","guid","defProp","on","once","off","offOnce","trigger","renderer","render","refresher","destroyer","render","refresh","destroy","defSettings"].indexOf(t)>-1)return this;if(void 0===r)var r=null;if(!e)var e=function(r){this["_"+t]=r,this.trigger("set"+t+" "+t,r),this.refresh(t)};if(!i)var i=function(){return this.trigger("get"+t+" "+t,this["_"+t]),this["_"+t]};return this["_"+t]=r,Object.defineProperty(this,t,{get:i,set:e}),this.refresh(t),this},this.defSettings=function(t){if(void 0===t)var t={};return this.defProp("settings",t,function(t){this._settings=$.extend(this._settings,t),this.trigger("setsettings settings",this._settings),this.refresh("settings")})},this.on=function(t,r){"function"==typeof t&&void 0===r&&(r=t,t="all"),t=t.toLowerCase().split(" ");for(var e=0;e<t.length;e++)this._handlers.push({event:t[e],handler:r});return this},this.once=function(t,r){"function"==typeof t&&void 0===r&&(r=t,t="all"),t=t.toLowerCase().split(" ");for(var e=0;e<t.length;e++)this._onceHandlers.push({event:t[e],handler:r});return this},this.off=function(t,r){if(void 0===r&&"function"==typeof t)for(var r=t,e=0;e<this._handlers.length;e++)this._handlers[e].handler==r&&this._handlers.splice(e--,1);else if(void 0===r&&"string"==typeof t){t=t.toLowerCase().split(" ");for(var e=0;e<this._handlers.length;e++)t.indexOf(this._handlers[e].event)>-1&&this._handlers.splice(e--,1)}else{t=t.toLowerCase().split(" ");for(var e=0;e<this._handlers.length;e++)t.indexOf(this._handlers[e].event)>-1&&this._handlers[e].handler==r&&this._handlers.splice(e--,1)}return this},this.offOnce=function(t,r){if(void 0===r&&"function"==typeof t)for(var r=t,e=0;e<this._onceHandlers.length;e++)this._onceHandlers[e].handler==r&&this._onceHandlers.splice(e--,1);else if(void 0===r&&"string"==typeof t){t=t.toLowerCase().split(" ");for(var e=0;e<this._onceHandlers.length;e++)t.indexOf(this._onceHandlers[e].event)>-1&&this._onceHandlers.splice(e--,1)}else{t=t.toLowerCase().split(" ");for(var e=0;e<this._onceHandlers.length;e++)t.indexOf(this._onceHandlers[e].event)>-1&&this._onceHandlers[e].handler==r&&this._onceHandlers.splice(e--,1)}return this},this.trigger=function(t,r){t=t.toLowerCase().split(" ");for(var e=0;e<this._handlers.length;e++)(t.indexOf(this._handlers[e].event)>-1||"all"==this._handlers[e].event)&&toFunc(this._handlers[e].handler).call(this,this._handlers[e].event,r);for(var e=0;e<this._onceHandlers.length;e++)(t.indexOf(this._onceHandlers[e].event)>-1||"all"==this._handlers[e].event)&&(toFunc(this._onceHandlers[e].handler).call(this,this._onceHandlers[e].event,r),this._onceHandlers.splice(e--,1));return this},this.renderer=function(){var t=$("<div class='Obj'></div>");for(var r in this)0==r.indexOf("_")&&-1==["_parent","_handlers","_onceHandlers","_elements"].indexOf(r)&&t.append("<div class='Obj-prop'><div class='Obj-prop-key'>"+r.substr(1)+"</div><div class='Obj-prop-value'>"+this[r]+"</div></div>");return t},this.refresher=function(t){return this.renderer.apply(this)},this.destroyer=function(t){},this.render=function(t,r){var e=this;if(void 0===t)var t="body";if(void 0===r)var r="replace";else r=r.toLowerCase();var i=[].slice.call(arguments,2),n=this;return $(t).each(function(t,s){s=$(s);var o=$(e.renderer.apply(e,i));o.attr("guid",e.guid),e._elements=e._elements.add(o),"append"==r?s.append(o):"prepend"==r?s.prepend(o):"after"==r?s.after(o):"before"==r?s.before(o):"return"==r?n=o:"none"==r||(s.after(o),s.remove())}),this.trigger("render"),n},this.refresh=function(t){for(var r=$(),e=0;e<this._elements.length;e++){var i=this._elements.eq(e),n=this.refresher.call(this,i,t);n?(n.attr("guid",this.guid),this._elements=this._elements.not(i),i.after(n),i.remove(),r=r.add(n)):r=r.add(i)}return this._elements=r,this},this.destroy=function(){var t=this;return this._elements.each(function(r,e){var i=$(e);t.destroyer.call(t,i)}),this._elements.remove(),this._elements=$(),delete Objs[this.guid],this},Objs[this.guid]=this}var GUIDList=[],Objs={};
