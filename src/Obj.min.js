function extend(t,e){t.prototype=new e,t.prototype.constructor=t}var Obj=function(){this._handlers=[],this._onceHandlers=[],this._elements=$(),this.on=function(t,e){"function"==typeof t&&void 0===e&&(e=t,t="all"),t=t.toLowerCase().split(" ");for(var i=0;i<t.length;i++)this._handlers.push({event:t[i],handler:e});return this},this.once=function(t,e){"function"==typeof t&&void 0===e&&(e=t,t="all"),t=t.toLowerCase().split(" ");for(var i=0;i<t.length;i++)this._onceHandlers.push({event:t[i],handler:e});return this},this.off=function(t,e){if(void 0===e&&"function"==typeof t)for(var e=t,i=0;i<this._handlers.length;i++)this._handlers[i].handler==e&&this._handlers.splice(i--,1);else if(void 0===e&&"string"==typeof t){t=t.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)t.indexOf(this._handlers[i].event)>-1&&this._handlers.splice(i--,1)}else{t=t.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)t.indexOf(this._handlers[i].event)>-1&&this._handlers[i].handler==e&&this._handlers.splice(i--,1)}return this},this.offOnce=function(t,e){if(void 0===e&&"function"==typeof t)for(var e=t,i=0;i<this._onceHandlers.length;i++)this._onceHandlers[i].handler==e&&this._onceHandlers.splice(i--,1);else if(void 0===e&&"string"==typeof t){t=t.toLowerCase().split(" ");for(var i=0;i<this._onceHandlers.length;i++)t.indexOf(this._onceHandlers[i].event)>-1&&this._onceHandlers.splice(i--,1)}else{t=t.toLowerCase().split(" ");for(var i=0;i<this._onceHandlers.length;i++)t.indexOf(this._onceHandlers[i].event)>-1&&this._onceHandlers[i].handler==e&&this._onceHandlers.splice(i--,1)}return this},this.trigger=function(t,e){t=t.toLowerCase().split(" ");for(var i=0;i<this._handlers.length;i++)(t.indexOf(this._handlers[i].event)>-1||t.indexOf("all")>-1)&&this._handlers[i].handler.call(this,this._handlers[i].event,e);for(var i=0;i<this._onceHandlers.length;i++)(t.indexOf(this._onceHandlers[i].event)>-1||t.indexOf("all")>-1)&&(this._onceHandlers[i].handler.call(this,this._onceHandlers[i].event,e),this._onceHandlers.splice(i--,1));return t.indexOf("change")>-1&&this.refresh(),this},this.subscribe=function(t){return void 0!=t.listener&&"function"==typeof t.listener&&this.on("all",t.listener),this},this.ubsubscribe=function(t){return void 0!=t.listener&&"function"==typeof t.listener&&this.off("all",t.listener),this},this.publish=function(t,e){return this.trigger(t,e)},this.renderer=function(){return $("<div class='Obj'></div>")},this.refresher=function(t){return this.renderer.apply(this)},this.destroyer=function(t){},this.render=function(t,e){var i=this;if(void 0===t)var t="body";if(void 0===e)var e="replace";else e=e.toLowerCase();var r=[].slice.call(arguments,2),s=this;return $(t).each(function(t,n){n=$(n);var a=i.renderer.apply(i,r);i._elements=i._elements.add(a),"append"==e?n.append(a):"prepend"==e?n.prepend(a):"after"==e?n.after(a):"before"==e?n.before(a):"return"==e?s=a:"none"==e||(n.after(a),n.remove())}),s},this.refresh=function(){for(var t=$(),e=0;e<this._elements.length;e++){var i=this._elements.eq(e),r=this.refresher.call(this,i);r?(i.after(r),i.remove(),t=t.add(r)):t=t.add(i)}return this._elements=t,this},this.destroy=function(){var t=this;return this._elements.each(function(e,i){i=$(i),t.destroyer(i)}),this._elements.remove(),this._elements=$(),this}};