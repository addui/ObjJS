function generateGUID(){do var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});while(GUIDList.indexOf(e)>-1);return e}function toFunc(e){if("function"==typeof e)return e;if("string"==typeof e){if(void 0!=window[e]&&"function"==typeof window[e])return window[e];try{return new Function(e)}catch(t){}}return function(){return e}}function Obj(){this._parent=null,this._handlers=[],this._onceHandlers=[],this._elements=$(),this.guid=generateGUID(),this.defProp=function(e,t,n,i){if(["parent","handlers","onceHandlers","elements","guid","defProp","on","once","off","offOnce","trigger","renderer","render","refresher","destroyer","render","refresh","destroy","defSettings"].indexOf(e)>-1)return this;if(void 0===t)var t=null;if(!n)var n=function(t){this["_"+e]=t,this.trigger("set"+e+" "+e,t),this.refresh(e)};if(!i)var i=function(){return this.trigger("get"+e+" "+e,this["_"+e]),this["_"+e]};return this["_"+e]=t,Object.defineProperty(this,e,{get:i,set:n}),this.refresh(e),this},this.defSettings=function(e){if(void 0===e)var e={};return this.defProp("settings",e,function(t){this._settings=$.extend(this._settings,e),this.trigger("setsettings settings",this._settings),this.refresh("settings")})},this.on=function(e,t){"function"==typeof e&&void 0===t&&(t=e,e="all"),e=e.toLowerCase().split(" ");for(var n=0;n<e.length;n++)this._handlers.push({event:e[n],handler:t});return this},this.once=function(e,t){"function"==typeof e&&void 0===t&&(t=e,e="all"),e=e.toLowerCase().split(" ");for(var n=0;n<e.length;n++)this._onceHandlers.push({event:e[n],handler:t});return this},this.off=function(e,t){if(void 0===t&&"function"==typeof e)for(var t=e,n=0;n<this._handlers.length;n++)this._handlers[n].handler==t&&this._handlers.splice(n--,1);else if(void 0===t&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var n=0;n<this._handlers.length;n++)e.indexOf(this._handlers[n].event)>-1&&this._handlers.splice(n--,1)}else{e=e.toLowerCase().split(" ");for(var n=0;n<this._handlers.length;n++)e.indexOf(this._handlers[n].event)>-1&&this._handlers[n].handler==t&&this._handlers.splice(n--,1)}return this},this.offOnce=function(e,t){if(void 0===t&&"function"==typeof e)for(var t=e,n=0;n<this._onceHandlers.length;n++)this._onceHandlers[n].handler==t&&this._onceHandlers.splice(n--,1);else if(void 0===t&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var n=0;n<this._onceHandlers.length;n++)e.indexOf(this._onceHandlers[n].event)>-1&&this._onceHandlers.splice(n--,1)}else{e=e.toLowerCase().split(" ");for(var n=0;n<this._onceHandlers.length;n++)e.indexOf(this._onceHandlers[n].event)>-1&&this._onceHandlers[n].handler==t&&this._onceHandlers.splice(n--,1)}return this},this.trigger=function(e,t){e=e.toLowerCase().split(" ");for(var n=0;n<this._handlers.length;n++)(e.indexOf(this._handlers[n].event)>-1||"all"==this._handlers[n].event)&&toFunc(this._handlers[n].handler).call(this,this._handlers[n].event,t);for(var n=0;n<this._onceHandlers.length;n++)(e.indexOf(this._onceHandlers[n].event)>-1||"all"==this._handlers[n].event)&&(toFunc(this._onceHandlers[n].handler).call(this,this._onceHandlers[n].event,t),this._onceHandlers.splice(n--,1));return this},this.renderer=function(){var e=$("<div class='Obj'></div>");for(var t in this)0==t.indexOf("_")&&-1==["_parent","_handlers","_onceHandlers","_elements"].indexOf(t)&&e.append("<div class='Obj-prop'><div class='Obj-prop-key'>"+t.substr(1)+"</div><div class='Obj-prop-value'>"+this[t]+"</div></div>");return e},this.refresher=function(e){return this.renderer.apply(this)},this.destroyer=function(e){},this.render=function(e,t){var n=this;if(void 0===e)var e="body";if(void 0===t)var t="replace";else t=t.toLowerCase();var i=[].slice.call(arguments,2),r=this;return $(e).each(function(e,s){s=$(s);var h=$(n.renderer.apply(n,i));h.attr("guid",n.guid),n._elements=n._elements.add(h),"append"==t?s.append(h):"prepend"==t?s.prepend(h):"after"==t?s.after(h):"before"==t?s.before(h):"return"==t?r=h:"none"==t||(s.after(h),s.remove())}),this.trigger("render"),r},this.refresh=function(e){for(var t=$(),n=0;n<this._elements.length;n++){var i=this._elements.eq(n),r=this.refresher.call(this,i,e);r?(r.attr("guid",this.guid),this._elements=this._elements.not(i),i.after(r),i.remove(),t=t.add(r)):t=t.add(i)}return this._elements=t,this},this.destroy=function(){var e=this;return this._elements.each(function(t,n){var i=$(n);e.destroyer.call(e,i)}),this._elements.remove(),this._elements=$(),delete Objs[this.guid],this},Objs[this.guid]=this}var GUIDList=[],Objs={};
